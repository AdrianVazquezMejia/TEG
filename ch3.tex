\section{Diseño de una red mallada basada en el microcontrolador ESP32}

La red mallada se diseño para una sola red Modbus, por lo que, solo puede existir un maestro y una cantidad de XXX esclavos (Citacion required). Teniendo en consideración lo anterior, se definió la topología de la red mallada; las rutas de comunicación se definieron según el esclavo que el maestro Mosbus esté interrogando. Así, aunque las rutas son estáticas, el enrutamiento de cada nodo varia según una tabla fija de enrutamiento determinada. 

Por otro lado, existen otras características  de comunicación como lo es el estándar del bus serial y la características del mismo. Ya que se usa el estándar RS-485, quedaba por definir la tasa de transmisión. Esta puede variar, por lo que el nodo es configurable y compatible para las tasas de Baudios siguientes: 

Entonces, quedando diferenciadas las dos etapas (la inalambrica y la serial) y además, se consideraron los dos sentidos de la información (desde y hacia el esclavo), para establecer una lógica para el funcionamiento del nodo. 

Cada nodo contemplaron dos sentidos, el primero es si se le introduce la información por el bus serial entonces esta debe transmitirse inalambricamente; y si recibe información inalambricamente entonces debe pasarla a su bus serial o bien debe trasnmitirla a otro nodo.

Cada  nodo debe ser configurable respecto a su identificador, tabla de enrutamiento y  tasa de baudios de la interfaz serial, para así adaptarlos a los entornos de comunicación industriales. Sabiendo que se transmite el protocolo Modbus entoinces se consideró conveniente considerar a los nodos como esclavos en el sistema. Se reservaron identificadores para los nodos, lo que deja menos cantidad de identificadores de esclavos disponibles para la red en la que se implemente la red mallada.

La comunicación entre los nodos es unicast para así aprovechar las ventajas que esto implica como lo son encriptación, respuesta de agradecimiento y ahorro de (sobrecarga). Para tener mayor cobertura, los esclavos pueden estar a mas de un nodo intermedio del nodo que posee el maestro y la red se diseño para poseyera la capacidad de reenviar dicha información  convenientemente.

Definidas estar características de funcionamiento, se investigaron las librerías que el microcontrolador ESP32 poseía para hacer tales funciones. Se encontraros dos tipos de redes WiFi descritos por Espressif: mesh y espnow. Para elegir cual usar se tomó en cuenta la flexibilidad, descentralización, seguridad y alcance; pues bien son las cualidades que entraban en concordancia para la elaboración de la arquitectura de red descrita anteriormente.

\section{Implementar el módulo del programa para el manejo del protocolo Modbus en el bus RS-485.}

Como se  trabajó en en microcontrolador ESP32, los programas elaborados son administrados por un sistema operativo en tiempo real (RTOS). Al mismo tiempo, el diseño de los programas contempló todas las características que un RTOS implica. Esto se traduce en un paradigma de programación basado en tareas, eventos, colas, etc.
